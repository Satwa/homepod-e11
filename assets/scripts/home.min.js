var video_already_played=!1,clientHeight=document.documentElement.clientHeight,sectionsToAnim=document.querySelectorAll(".entryAnim:not(.opened)"),body=document.querySelector("body"),html=document.querySelector("html"),homepod_container=html.querySelector(".homepodContainer"),hello_siri=body.querySelector("#hello_siri"),at_home=body.querySelector("#at-home"),slider=document.querySelector(".slider"),slider__container=document.querySelector(".slider__container"),slides=document.querySelectorAll(".slider__container__infoCard"),
slidesCounter=slides.length,arrow_left=document.querySelector("#arrow-left"),arrow_right=document.querySelector("#arrow-right"),pos=0,slide_width=slider.offsetWidth;updateScrollPosition();setInfoCardWidth();window.onscroll=function(){updateScrollPosition()};window.addEventListener("resize",function(){clientHeight=document.documentElement.clientHeight;slide_width=slider.offsetWidth;move();setInfoCardWidth()});
function updateScrollPosition(){var a=getScrollPosition();homepod_container.style.top=.3*-a+"px";entryAnimations(a);homepodAtHome(a);hello_siri.currentTime=(a-(hello_siri.offsetTop-2*clientHeight/3))/100}function entryAnimations(a){for(var b=0;b<sectionsToAnim.length;b++)sectionsToAnim[b].offsetTop-2*clientHeight/3<a&&(sectionsToAnim[b].classList.add("opened"),--b,sectionsToAnim=document.querySelectorAll(".entryAnim:not(.opened)"))}
function homepodAtHome(a){var b=at_home.offsetTop-clientHeight;b<a&&(a=(a-b)/at_home.offsetHeight,at_home.style.opacity=a,1<a?at_home.classList.add("animationEnded"):at_home.classList.remove("animationEnded"))}function getScrollPosition(){scrollBody=body.scrollTop;scrollHtml=html.scrollTop;return 0==scrollBody?scrollHtml:scrollBody}function setInfoCardWidth(){for(var a=0;a<slides.length;a++)slides[a].style.width=slide_width-arrow_left.offsetWidth-arrow_right.offsetWidth+"px"}
arrow_left.addEventListener("click",function(a){a.preventDefault();0>pos-1?(slider__container.style.transition="top 0s",slider__container.style.left=-(slide_width*slidesCounter)+"px",setTimeout(function(){slider__container.style.transition="left .25s linear";pos=(pos-1+slidesCounter)%slidesCounter;move()},5)):(pos=(pos-1+slidesCounter)%slidesCounter,move())});
arrow_right.addEventListener("click",function(a){a.preventDefault();pos+1>=slidesCounter?(slider__container.style.transition="top 0s",slider__container.style.left=slide_width+"px",setTimeout(function(){slider__container.style.transition="left .25s linear";pos=(pos+1)%slidesCounter;move()},5)):(pos=(pos+1)%slidesCounter,move())});
function move(){document.querySelector("#homepod-state-"+pos).classList.add("homepodContainer__homepodFocused");document.querySelector(".card-focused").classList.toggle("card-focused");slides[pos].classList.add("card-focused");slider__container.style.left=-(slide_width*pos)+"px";setTimeout(function(){var a=document.querySelector(".homepodContainer__homepodFocused:not(#homepod-state-"+pos+")");null!=a&&a.classList.toggle("homepodContainer__homepodFocused")},300)}
var space_recognition_video_control,space_recognition_video;window.onload=function(){loadSpaceRecognitionVideo()};
function loadSpaceRecognitionVideo(){var a=document.querySelector("#spaceRecognitionVideo");fetch("https://homepod.joshua.ovh/async/space_recognition.html").then(function(a){return a.text()}).then(function(b){a.innerHTML=b;space_recognition_video_control=html.querySelector(".video_container__control");space_recognition_video=html.querySelector("#space_recognition");space_recognition_video.onPlay=playVideo();space_recognition_video.onended=pauseVideo;space_recognition_video_control.addEventListener("click",
function(a){a.preventDefault();space_recognition_video.paused?playVideo():pauseVideo()})})["catch"](function(a){console.log("Failed to fetch page: ",a)})}function playVideo(){space_recognition_video.play();space_recognition_video.paused||space_recognition_video_control.classList.add("playing")}function pauseVideo(){space_recognition_video.pause();space_recognition_video_control.classList.remove("playing")};
